
template: focal.yaml

#use galsim.des (for DES_PSFEx) as well as galsim_extra
modules:
    - galsim_extra
    - galsim.des

psf:
    type: DES_PSFEx

image.noise:
    type: FitsNoise
    hdu: 2
    dir: '@image.wcs.dir'
    file_name: '@image.wcs.file_name'
    bkg_hdu: 1
    bkg_file_name:
        type: FormattedStr
        format: "%s_%02d_bkg.fits.fz"
        items:
        - { type: Catalog, col: 1 }
        - "$chip_num + 1"


input.des_psfex:
    dir: 
        type: Catalog
        col: 0
    file_name:
        type: FormattedStr
        format: "%s_%02d_psfcat.psf"
        items:
        - { type: Catalog, col: 1 }
        - "$chip_num + 1"
    image_file_name:
        type: FormattedStr
        format: "%s_%02d.fits.fz"
        items:
        - { type: Catalog, col: 1 }
        - "$chip_num + 1"

output.nchips: 2

#output.exclude: [31, 61]

#remove psf_params from output
output.truth.columns:
    num: obj_num
    x: "$image_pos.x"
    y: "$image_pos.y"

    obj_type: '@current_obj_type'
    obj_type_index: '@current_obj_type_index'
    flux: "$(@current_obj).flux"
    shear_g1: stamp.shear.g1
    shear_g2: stamp.shear.g2

    gal_hlr: '$gal_hlr'
    bulge_g1: '$bulge_g1'
    bulge_g2: '$bulge_g2'
    disk_g1: '$disk_g1'
    disk_g2: '$disk_g2'
